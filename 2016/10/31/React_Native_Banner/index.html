<!DOCTYPE html>
<html>
    <head>
    <!-- Title -->
    
    <title>
        React Native Banner的实现 | mashell
    </title>
    
    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">
    
    <!-- Meta & INfo -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#039BE5">
    <meta name="author" content="mashell">
    <meta name="description" content="还有什么比不浪费时间更有意义的事呢？">
    <meta name="keywords" content="null">
    
    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="mashell">
    
    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://mashell.cn">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="React Native Banner的实现 | mashell">
    <meta property="og:description" content="还有什么比不浪费时间更有意义的事呢？">
    
     <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">
        
        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->
    
    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->

<!-- Theme Background -->

    <style>
        body{
            background-color: #F5F5F5
        }
		
        #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
            background-color: #fff;
        }
		
        #scheme-Paradox .MD-burger-layer {
            background-color: #666;
        }
		
        #scheme-Paradox .material-back{
            color: #666;
        }
		
        .material-layout .material-post>.material-nav,
		.material-layout .material-index>.material-nav,
        .material-nav a,
        #scheme-Paradox .material-post_container .material-back{
            color: #666;
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>


<!-- Other Styles -->
<style>
	body, html{
		font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
	}
	
    a{
        color: #039BE5
    }
    
    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #039BE5 !important
    }
    
	/* Sidebar User Drop Down Menu Text Color */
	#scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus{
        color: #039BE5 !important
    }
    
    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a{
        color: #039BE5 !important
    }
    
    .toTop{
        background: #00BCD4 !important
    }
</style>
	<script src="/js/jquery.min.js"></script>
	
	<!-- UC Browser Compatible-->
	<script>
		var agent = navigator.userAgent.toLowerCase();
		if(agent.indexOf('ucbrowser')>0) {
			document.write('<link rel="stylesheet" href="/css/uc.css">');
		   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
		}
	</script>
    
    <!-- Custom Head -->
    
</head>
	
	

    <body id="scheme-Paradox">

		
        <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
				
			
			
            <!-- Main Container -->
            <main class="material-layout__content" id="main">
				
                <!-- Top Anchor -->
                <div id="top"></div>
				
				
                <!-- Hamburger Button -->
                <button class="MD-burger-icon sidebar-toggle">
                    <span class="MD-burger-layer"></span>
                </button>
				
				
                
	<!-- Back Button -->
	<div class="material-back" id="backhome-div" tabindex="0">
		<a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" href="#" onclick="window.history.back();return false;" target="_self" role="button" data-upgraded=",MaterialButton,MaterialRipple">
			<i class="material-icons" role="presentation">arrow_back</i>
			<span class="mdl-button__ripple-container">
				<span class="mdl-ripple"></span>
			</span>
		</a>
	</div>			


<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">
        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
	<!-- Paradox Post Header -->
	
		
			<!-- Random Thumbnail -->
			<div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
				<script>
    
    var randomNum;
    randomNum = Math.floor(Math.random() * 5 + 1);
    
    $(".post_thumbnail-random").css('background-image', 'url(' + '/img/random/' + randomNum + '.png' + ')');
    
</script>

		
	
        <p class="article-headline-p">
            React Native Banner的实现
        </p>
    </div>

	

				
				
					<!-- Paradox Post Info -->
					<div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">
    
    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>mashell</strong>
        <span>10月 31, 2016</span>
    </div>
    
    <div class="section-spacer"></div>
	
    <!-- Favorite -->
<!--
    <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
        <i class="material-icons" role="presentation">favorite</i>
        <span class="visuallyhidden">favorites</span>
    </button>
-->
    
    <!-- Tags (bookmark) -->
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/react-native/">react native</a>
    </ul>
    
    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    
    <!-- Leancloud Views -->
    <a class="post_share-link" href="#">
        <li class="mdl-menu__item">
            <span id="/2016/10/31/React_Native_Banner/" class="leancloud-views_num" data-flag-title="React Native Banner的实现">
     &nbsp;浏览量
</span>
        </li>
    </a>
    
    
    
    
    <!-- Share Twitter -->
    <a class="post_share-link" href="https://twitter.com/intent/tweet?text=React Native Banner的实现&url=http://mashell.cn//2016/10/31/React_Native_Banner/index.html&via=mashell" target="_blank">
        <li class="mdl-menu__item">
            分享到 Twitter
        </li>
    </a>
    
    <!-- Share Google+ -->
    <a class="post_share-link" href="https://plus.google.com/share?url=http://mashell.cn//2016/10/31/React_Native_Banner/index.html" target="_blank">
        <li class="mdl-menu__item">
            分享到 Google+
        </li>
    </a>
    
    <!-- Share Weibo -->
    <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=React Native Banner的实现&url=http://mashell.cn//2016/10/31/React_Native_Banner/index.html&pic=&searchPic=false&style=simple" target="_blank">
        <li class="mdl-menu__item">
            分享到微博
        </li>
    </a>
</ul>
</div>
				

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
	
		<h2 id="分析需求"><a href="#分析需求" class="headerlink" title="分析需求"></a>分析需求</h2><p><img src="http://o7q9l32cf.bkt.clouddn.com/6632195864628989856.png" alt=""></p>
<ol>
<li><p>banner中滚动的图片，其实就是一个水平的scrollView，内容为止一张一张的图片，然后通过定时器让他定时滚动</p>
</li>
<li><p>banner最下方是一个View，</p>
</li>
</ol>
<ul>
<li>其中左边部分是图片对应的文字解释,是一个Text</li>
<li>右边是指示器，圆点个数与图片个数相同，两种颜色的圆点其实也是文字, &amp;bull； 他是html中特殊的符号，显示出来就是一个圆点，我们通过设置字体颜色就可以显示出两种不同的指示器点了,是一个View里面包裹了一个Text和指示器View指示器中包裹着圆点的Text</li>
</ul>
<h2 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h2><h3 id="写在前面，-我们看看state和props中有哪些我们需要用到的自定义属性"><a href="#写在前面，-我们看看state和props中有哪些我们需要用到的自定义属性" class="headerlink" title="写在前面， 我们看看state和props中有哪些我们需要用到的自定义属性"></a>写在前面， 我们看看state和props中有哪些我们需要用到的自定义属性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">getDefaultProps()&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">       <span class="comment">//banner的定时器自动滚动时间</span></div><div class="line">            intervalTime: <span class="number">3000</span></div><div class="line">     &#125;</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    getInitialState()&#123;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">        	<span class="comment">//banner的全部数据，一个数组</span></div><div class="line">            bannerArray: [],</div><div class="line">            <span class="comment">//banner左下方显示的文字描述</span></div><div class="line">            bannerText: <span class="string">''</span>,</div><div class="line">            <span class="comment">//banner显示第几页图片的属性</span></div><div class="line">            currentPage: <span class="number">0</span>,</div><div class="line">        &#125;</div><div class="line">    &#125;,</div></pre></td></tr></table></figure>
<h3 id="获取网络数据，并且将数据保存在state中，"><a href="#获取网络数据，并且将数据保存在state中，" class="headerlink" title="获取网络数据，并且将数据保存在state中，"></a>获取网络数据，并且将数据保存在state中，</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">getBannerData()&#123;</div><div class="line">   fetch(<span class="string">'http://www.mywebsite.com/getBanner'</span>)</div><div class="line">    .then(<span class="function">(<span class="params">response</span>)=&gt;</span>response.json())</div><div class="line">     .then(<span class="function">(<span class="params">responderJson</span>)=&gt;</span> &#123;</div><div class="line">      <span class="keyword">var</span> jsonData = responderJson.data;</div><div class="line">            <span class="keyword">this</span>.setState(&#123;</div><div class="line">             <span class="attr">bannerArray</span>: jsonData,</div><div class="line">              <span class="comment">//让banner左下角默认显示第一个文字描述</span></div><div class="line">                bannerText: jsonData[<span class="number">0</span>].banner_desc</div><div class="line">              &#125;)</div><div class="line">          &#125;)</div><div class="line">         .catch(<span class="function">(<span class="params">error</span>)=&gt;</span> &#123;</div><div class="line">            <span class="built_in">console</span>.error(error);</div><div class="line">         &#125;);</div><div class="line">    &#125;,</div></pre></td></tr></table></figure>
<h3 id="代码中添加ScrollView组件"><a href="#代码中添加ScrollView组件" class="headerlink" title="代码中添加ScrollView组件"></a>代码中添加ScrollView组件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ScrollView</span></span></div><div class="line">	<span class="attr">style</span>=<span class="string">&#123;styles.scrollStyle&#125;</span></div><div class="line">	//使用<span class="attr">refs</span>属性，导出<span class="attr">scrollview</span>组件，方便后面 第六步 操作<span class="attr">scrollvIew</span></div><div class="line">    <span class="attr">ref</span>=<span class="string">"bannerScroll"</span></div><div class="line">    //让<span class="attr">scrollview</span>水平滚动</div><div class="line">    <span class="attr">horizontal</span>=<span class="string">&#123;true&#125;</span></div><div class="line">    //显示滚动条</div><div class="line">    <span class="attr">showsHorizontalScrollIndicator</span>=<span class="string">&#123;false&#125;</span></div><div class="line">    //设置弹性滚动</div><div class="line">    <span class="attr">pagingEnabled</span>=<span class="string">&#123;true&#125;</span></div><div class="line">    //监听<span class="attr">scroll</span>滚动</div><div class="line">    <span class="attr">onMomentumScrollEnd</span>=<span class="string">&#123;(e)</span>=&gt;this.onAnimationEnd(e)&#125;</div><div class="line">    //开始拖拽时banner停止自滚动</div><div class="line">    onScrollBeginDrag=&#123;this.onScrollBeginDrag&#125;</div><div class="line">    //停止拖拽时banner开始自滚动</div><div class="line">    onScrollEndDrag=&#123;this.onScrollEndDrag&#125;&gt;</div><div class="line">         </div><div class="line">    //为scrollview填充图片的方法</div><div class="line">    &#123;this.renderBannerImg()&#125;</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="为scrollview中添加图片"><a href="#为scrollview中添加图片" class="headerlink" title="为scrollview中添加图片"></a>为scrollview中添加图片</h3><p>建立一个数组，数组中添加图片，图片的uri为第二步网络请求中得到的数据，并将数据返回给scrollview</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">renderBannerImg()&#123;</div><div class="line">	<span class="keyword">var</span> allBanner = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.state.bannerArray.length; i++) &#123;</div><div class="line">        allBanner.push(<span class="xml"><span class="tag">&lt;<span class="name">Image</span> <span class="attr">key</span>=<span class="string">&#123;i&#125;</span></span></span></div><div class="line">        <span class="attr">source</span>=<span class="string">&#123;&#123;uri:this.state.bannerArray[i].banner_pic&#125;&#125;</span></div><div class="line">        <span class="attr">style</span>=<span class="string">&#123;styles.bannerImage&#125;/</span>&gt;)</div><div class="line">     &#125;</div><div class="line">      return allBanner;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><strong>到目前为止，banner中的图片已经被我们实现出来了，我们接着实现图片下方的View</strong></p>
<h3 id="下方文字提示以及指示器的view"><a href="#下方文字提示以及指示器的view" class="headerlink" title="下方文字提示以及指示器的view"></a>下方文字提示以及指示器的view</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.bannerTextContainer&#125;</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">Text</span> <span class="attr">style</span>=<span class="string">&#123;styles.bannerTextStyle&#125;</span>&gt;</span>&#123;this.state.bannerText&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;styles.bannerPointContainer&#125;</span>&gt;</span>&#123;this.renderBannerPoint()&#125;<span class="tag">&lt;/<span class="name">View</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">View</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="为指示器添加圆点"><a href="#为指示器添加圆点" class="headerlink" title="为指示器添加圆点"></a>为指示器添加圆点</h3><ul>
<li><p>为了让指示器的圆点显示随着上方图片的变化而变化，我们需要先在state中设置一个currentPage属性，并且通过scrollview的横坐标值计算出当前是第几张图片，并且更新currentPage，后面指示器圆点显示会根据currentPage值改变而改变</p>
</li>
<li><p>监听横坐标值我们需要设置实现onMomentumScrollEnd方法</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">onAnimationEnd(e)&#123;</div><div class="line"><span class="comment">//计算出scrollView水平滚动的距离</span></div><div class="line"><span class="keyword">var</span> offsetX = e.nativeEvent.contentOffset.x;</div><div class="line"><span class="comment">//计算出当前页数,同时更新当前页数currentPage</span></div><div class="line"><span class="keyword">var</span> currentPage = <span class="built_in">Math</span>.floor(offsetX / width)</div><div class="line"><span class="keyword">var</span> bannerText = <span class="keyword">this</span>.state.bannerArray[currentPage].banner_desc;</div><div class="line">	<span class="keyword">this</span>.setState(&#123;</div><div class="line">	   <span class="attr">currentPage</span>: <span class="built_in">Math</span>.floor(offsetX / width),</div><div class="line">	   <span class="attr">bannerText</span>: bannerText</div><div class="line">	  &#125;)</div><div class="line">	&#125;,</div></pre></td></tr></table></figure>
<h3 id="设置圆点显示"><a href="#设置圆点显示" class="headerlink" title="设置圆点显示"></a>设置圆点显示</h3><p>得到了当前页数值，我们就依据这个currentPage设置圆点的显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">renderBannerPoint()&#123;</div><div class="line">	   var pointArray = [];</div><div class="line">	   for (var i = 0; i &lt; this.state.bannerArray.length; i++) &#123;</div><div class="line">	   //通过图片的位置计算出的当前页数来改变圆点的颜色，如果等于当前颜色就设置白色，证明是当前页数,反之</div><div class="line">	    var fontColor = (i == this.state.currentPage) ? &#123;color: &apos;white&apos;&#125; : &#123;color: &apos;rgba(220,220,220,0.8)&apos;&#125;;</div><div class="line">	     pointArray.push(&lt;Text key=&#123;i&#125; style=&#123;[styles.bannerPointStyle, fontColor]&#125;&gt;&amp;bull;&lt;/Text&gt;)</div><div class="line">	     &#125;</div><div class="line">	    return pointArray;</div><div class="line">	 &#125;,</div></pre></td></tr></table></figure>
<h3 id="设置定时器，让banner定时滚动"><a href="#设置定时器，让banner定时滚动" class="headerlink" title="设置定时器，让banner定时滚动"></a>设置定时器，让banner定时滚动</h3><p>到目前为止，静态的banner已经被我们实现出来了，我们接下来就要设置定时器，定时的更改currentPage，从而达到更改定时滚动图片以及圆点指示器的显示</p>
<ul>
<li>定时器为第三方库，引入后我们再render中注册后，</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> TimerMixin = <span class="built_in">require</span>(<span class="string">'react-timer-mixin'</span>);</div><div class="line">mixins: [TimerMixin],</div></pre></td></tr></table></figure>
<ul>
<li>通过this.setInterval(function(),1000)启动定时器，通过this.clearInterval(this.timer)停止定时器</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">startTimer()&#123;</div><div class="line">   <span class="comment">//引入scrollView便于后续操作</span></div><div class="line">   <span class="keyword">var</span> scrollView = <span class="keyword">this</span>.refs.bannerScroll;</div><div class="line">   </div><div class="line">	<span class="comment">//开启定时器</span></div><div class="line">   <span class="keyword">this</span>.timer = <span class="keyword">this</span>.setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;   </div><div class="line">   <span class="comment">//设置指示器圆点变换</span></div><div class="line">   <span class="keyword">var</span> timerPage = <span class="number">0</span>;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.state.currentPage + <span class="number">1</span> &gt;= <span class="keyword">this</span>.state.bannerArray.length) &#123;</div><div class="line">        timerPage = <span class="number">0</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          timerPage = <span class="keyword">this</span>.state.currentPage + <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">       <span class="keyword">this</span>.setState(&#123;</div><div class="line">           <span class="attr">currentPage</span>: timerPage</div><div class="line">       &#125;)</div><div class="line"></div><div class="line">      <span class="comment">//设置图片滚动变换,通过scrollResponderScrollTo可以滚动图片</span></div><div class="line">      <span class="keyword">var</span> offsetX = timerPage * width;</div><div class="line">      scrollView.scrollResponderScrollTo(&#123;<span class="attr">x</span>: offsetX, <span class="attr">y</span>: <span class="number">0</span>, <span class="attr">animated</span>: <span class="literal">true</span>&#125;)</div><div class="line">   		&#125;, <span class="keyword">this</span>.props.intervalTime);</div><div class="line"> &#125;,</div></pre></td></tr></table></figure>
<h3 id="设置滑动事件"><a href="#设置滑动事件" class="headerlink" title="设置滑动事件"></a>设置滑动事件</h3><p>一个定时滚动的banner已经被我们实现了，当然我们需要在手动滚动banner时停止原本设置好的自动滚动，我们就得监听开始拖动banner和停止拖动banner的动作，当拖动时停止定时器，当停止拖动离开banner时启动定时器</p>
<p><strong>开始拖动banner</strong>    </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">onScrollBeginDrag()&#123;</div><div class="line">    <span class="keyword">this</span>.clearInterval(<span class="keyword">this</span>.timer)</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p><strong>停止拖动banner</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">onScrollEndDrag()&#123;</div><div class="line">   <span class="keyword">this</span>.startTimer()</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p> 总的来说一个banner的实现主要用到scrollView的一些属性，然后通过定时器调用方法让scrollview自己滚动就达到了我们的目的了,是不是很简单呢[]~(￣▽￣)~*有疑问欢迎留言</p>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p>虽然博客搭了很久，但是这次是第一次写文章，写的时候发现markdown本地预览和实际上hexo自动生成的文件不一样，折腾了一个多小时，发现了两个问题</p>
<ul>
<li>标题#号后面需要加一个空格，要不然hexo识别不了</li>
<li>代码块```后面不能加空格！！切记，文章弄了很久还是格式错误就是这个原因，代码块语法后面千万别加空格 TT</li>
</ul>

	
	
	
	
</div>
				
				

                <!-- Post Comments -->
                
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #039BE5 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #039BE5 !important;
    }
    #ds-reset .ds-highlight {
        color: #039BE5 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
        <div class="ds-thread" data-thread-key="React Native Banner的实现" data-url="http://mashell.cn//2016/10/31/React_Native_Banner/index.html"></div>
    <!-- 多说评论框 end -->
</div>



				

            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
    <!-- Prev Nav -->
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
</nav>
        </div>
    </div>

				
				
					<!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay "></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored  sidebar-fixed-left" role="navigation">
	<div id="sidebar-main">
	    <!-- Sidebar Header -->
		<div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="mashell's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        mashell624@163.com
        <b class="caret"></b>
    </a>
</div>

		<!-- Sidebar Navigation  -->
		<ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
			
                <li>
                    <a href="#" target="_blank" title="Email Me">
						<i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
             主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
<!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
-->

	
    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">1</span></a>
        </ul>
    </li>

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
	

    <!-- Article Numebr  -->
    <li>
        <a href="#">
             文章总数
             <span class="sidebar-badge">1</span>
        </a>
    </li>
</ul>

		<!-- Sidebar Divider -->
		<div class="sidebar-divider"></div>

		<!-- Sidebar Footer -->
		<!-- 
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持。 :) 
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
	<div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		主题 - Material
		<span class="sidebar-badge badge-circle">i</span>
	</div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
		sidebar.help
		<span class="mdl-button__ripple-container">
			<span class="mdl-ripple"></span>
		</span>
	</div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

	</div>
    
    <!-- Sidebar Sponsor -->
    


</aside>

				
				
				
					<!-- Footer Top Button -->
					<div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>
				
				
				<!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
	
	
		<!-- Paradox Footer Left Section -->
		<div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
    
    
    <!-- Facebook -->
    
    
    
    <!-- Google + -->
    
    
    
    <!-- Weibo -->
    
    <a href="http://weibo.com/u/5181439439" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.png);">
        <span class="visuallyhidden">Weibo</span>
    </button></a>
    
    
    <!-- Instagram -->
    
    
    
    <!-- Tumblr -->
    
    
    
    <!-- Github -->
    
    <a href="https://github.com/mashell" target="view_window"><button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
        <span class="visuallyhidden">Github</span>
    </button></a>
    
</div>


		<!--Copyright-->
		<div id="copyright">Copyright&nbsp;©&nbsp;<script type="text/javascript">var fd = new Date();document.write(fd.getFullYear());</script>&nbsp;mashell</div>

		<!-- Paradox Footer Right Section -->

		<!-- 
		I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright.
		It will not impact the appearance and can give developers a lot of support :)

		很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
		它不会影响美观并可以给开发者很大的支持。 :) 
		-->

		<div class="mdl-mini-footer--right-section">
			<div>
				<div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
				<div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
			</div>
		</div>
	
    
</footer>
                
				<!-- Import File -->
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    
    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });
    
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>


	<script src="/js/smoothscroll.js"></script>



    <!-- Leancloud -->
	<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
	<script>
		AV.initialize("F8tDrPhvnflgmUOz88q2X3v8-gzGzoHsz", "7G2z5hgOyivnxFAKfLDqhTfK");
	</script>
    <script>
	function showTime(Counter) {
		var query = new AV.Query(Counter);
		$(".leancloud-views_num").each(function() {
			var url = $(this).attr("id").trim();
			query.equalTo("url", url);
			query.find({
				success: function(results) {
					if (results.length == 0) {
						var content = '0 ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
						return;
					}
					for (var i = 0; i < results.length; i++) {
						var object = results[i];
						var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
						$(document.getElementById(url)).text(content);
					}
				},
				error: function(object, error) {
					console.log("Error: " + error.code + " " + error.message);
				}
			});

		});
	}

	function addCount(Counter) {
		var Counter = AV.Object.extend("Counter");
		url = $(".leancloud-views_num").attr('id').trim();
		title = $(".leancloud-views_num").attr('data-flag-title').trim();
		var query = new AV.Query(Counter);
		query.equalTo("url", url);
		query.find({
			success: function(results) {
				if (results.length > 0) {
					var counter = results[0];
					counter.fetchWhenSave(true);
					counter.increment("time");
					counter.save(null, {
						success: function(counter) {
							var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(counter, error) {
							console.log('Failed to save Visitor num, with error message: ' + error.message);
						}
					});
				} else {
					var newcounter = new Counter();
					newcounter.set("title", title);
					newcounter.set("url", url);
					newcounter.set("time", 1);
					newcounter.save(null, {
						success: function(newcounter) {
							console.log("newcounter.get('time')="+newcounter.get('time'));
							var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
							$(document.getElementById(url)).text(content);
						},
						error: function(newcounter, error) {
							console.log('Failed to create');
						}
					});
				}
			},
			error: function(error) {
				console.log('Error:' + error.code + " " + error.message);
			}
		});
	}
	$(function() {
		var Counter = AV.Object.extend("Counter");
		if ($('.leancloud-views_num').length == 1) {
			addCount(Counter);
		} else if ($('.post-title-link').length > 1) {
			showTime(Counter);
		}
	}); 
</script>





    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"mashell"};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = 'https://static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0] 
             || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
    <!-- 多说公共 js 代码 end -->







            </main>
        </div>
		
    </body>
		
	
</html>
